<div class="ticket-form-container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>{{
        isEditMode ? "Edit Ticket" : "Add New Ticket"
      }}</mat-card-title>
      <mat-card-subtitle>{{
        isEditMode ? "Update ticket information" : "Create a new cinema ticket"
      }}</mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <form
        [formGroup]="ticketForm"
        (ngSubmit)="onSubmit()"
        class="ticket-form"
      >
        <div class="form-row">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Showtime</mat-label>
            <mat-select formControlName="showtimeId" [disabled]="isEditMode">
              <mat-option
                *ngFor="let showtime of showtimes"
                [value]="showtime.id"
              >
                {{ showtime.movieTitle }} -
                {{ showtime.startTime | date : "short" }} ({{ showtime.hall }})
              </mat-option>
            </mat-select>
            <mat-error
              *ngIf="ticketForm.get('showtimeId')?.hasError('required')"
            >
              Showtime is required
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Customer Name</mat-label>
            <input
              matInput
              formControlName="customerName"
              placeholder="Enter customer name"
            />
            <mat-error
              *ngIf="ticketForm.get('customerName')?.hasError('required')"
            >
              Customer name is required
            </mat-error>
            <mat-error
              *ngIf="ticketForm.get('customerName')?.hasError('minlength')"
            >
              Customer name must be at least 2 characters
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Email</mat-label>
            <input
              matInput
              formControlName="customerEmail"
              type="email"
              placeholder="Enter email address"
            />
            <mat-error
              *ngIf="ticketForm.get('customerEmail')?.hasError('required')"
            >
              Email is required
            </mat-error>
            <mat-error
              *ngIf="ticketForm.get('customerEmail')?.hasError('email')"
            >
              Please enter a valid email address
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Phone Number</mat-label>
            <input
              matInput
              formControlName="phoneNumber"
              placeholder="Enter phone number"
            />
            <mat-error
              *ngIf="ticketForm.get('phoneNumber')?.hasError('required')"
            >
              Phone number is required
            </mat-error>
            <mat-error
              *ngIf="ticketForm.get('phoneNumber')?.hasError('pattern')"
            >
              Please enter a valid phone number
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Seat Number</mat-label>
            <mat-select formControlName="seatNumber">
              <mat-option *ngFor="let seat of availableSeats" [value]="seat">
                Seat {{ seat }}
              </mat-option>
            </mat-select>
            <mat-error
              *ngIf="ticketForm.get('seatNumber')?.hasError('required')"
            >
              Seat number is required
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-actions">
          <button mat-button type="button" (click)="onCancel()">Cancel</button>
          <button
            mat-raised-button
            color="primary"
            type="submit"
            [disabled]="ticketForm.invalid"
          >
            {{ isEditMode ? "Update" : "Create" }} Ticket
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>
